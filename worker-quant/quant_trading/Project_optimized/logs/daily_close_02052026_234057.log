=============================================== 
[INFO] START 02/05/2026 Thu 23:40:57.08 
[INFO] CWD=E:\quantum\Project_optimized 
[INFO] Running: python run_pipeline.py --config config.yaml 
=============================================== 
ðŸš€ DB updater: start
âœ… å·²æ›´æ–° 27 åªè‚¡ç¥¨çš„åŸºç¡€ä¿¡æ¯
ðŸ“¥ Downloading 27 tickers: 2026-02-04 -> 2026-02-05
ðŸ“ˆ 4063.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 6367.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 5020.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8035.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 6857.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 6146.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 6758.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 6861.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8058.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8001.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8031.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8002.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8306.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8316.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8766.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 8591.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 7011.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 7012.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 7203.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 9101.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 9432.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 2914.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 9983.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 7974.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 4661.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 1321.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
ðŸ“ˆ 1570.T: å·²å­˜å‚¨ 2 æ¡Kçº¿æ•°æ®
âœ… Done. Rows upserted: 54. DB=japan_market.db
E:\quantum\Project_optimized\screener.py:62: FutureWarning: The default fill_method='pad' in DataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
  ret1 = close.pct_change()
âœ… Screener done: 27 tickers -> selected_tickers.json
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
E:\quantum\Project_optimized\ss6_sqlite.py:239: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px = px.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill")
E:\quantum\Project_optimized\ss6_sqlite.py:582: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  px_next = px_next.replace([np.inf, -np.inf], np.nan).fillna(method="ffill").fillna(method="bfill").clip(lower=1e-6)
======================================================================
ðŸš€ Running optimized backtest (capital-dependent execution + no look-ahead)
Initial capital: 200,000
======================================================================
1) Download data (incl. benchmark 1321.T) ...
2) Build features/targets (n=27) ...
3) Walk-forward backtest ...
Saved: reports\target_weights.csv

ðŸ“Š Summary
Final equity: 266,302
Total return: 33.15%
Max drawdown: -4.06%
Reports: reports\strategy_report.html, reports\strategy_report_extras.html, reports\weights_heatmap.html

ðŸ›¡ï¸ AMD 7900XTX note:
This script is CPU-only. If your browser/GPU driver is unstable when opening Plotly HTML,
keep safe_plot=True (default) and avoid opening multiple heavy HTML pages at once.
E:\quantum\Project_optimized\report_obsidian.py:2: SyntaxWarning: invalid escape sequence '\q'
  """Publish reports into an Obsidian vault folder.
âœ… Published: E:\quantum\quantum investment\Quant\Reports\2026-02-05\report.md
>> python db_update.py --db japan_market.db --lookback 730
>> python screener.py --db japan_market.db --topk 50 --minadv 20000000.0 --out selected_tickers.json --asof 2026-02-05
>> python ss6_sqlite.py (env-driven)
>> python report_obsidian.py --vault E:\quantum\quantum investment --report_dir reports --section Quant/Reports --asof 2026-02-05
=============================================== 
[INFO] END Thu 02/05/2026 23:41:05.83 RC=0 
=============================================== 
